name: Update data

on:
    workflow_dispatch:

jobs:
    config:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v2

            - name: Configure python
              uses: actions/setup-python@v3
              with:
                  python-version: "3.12"

            - name: Install Requirements
              run: pip install --no-cache-dir -r requirements

            - name: Configure Credentials
              env:
                  ERPCREDS: ${{ secrets.ERPCREDS }}
                  GMAIL_TOKEN: ${{ secrets.GMAIL_TOKEN }}
              run: |
                  echo "$ERPCREDS" > erpcreds.py
                  echo "$GMAIL_TOKEN" > wimp/token.json

            - name: Run the script
              run: python main.py auto

            - name: Check status (TEMP)
              run: git diff